<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Your App Title">
    <link rel="apple-touch-icon" href="https://i.imgur.com/V1zQRS2.png">
    <title>IES Stock Count</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/V1zQRS2.png">
    <link rel="stylesheet" href="Google Sheet.css">
    <style>
        *{
            box-sizing: border-box;
            padding: 0;
            margin: 0;
            font-family: 'poppins', sans-serif;
            font-size: 18px;
        }
        body{
            background-image: url('https://i.imgur.com/6QnL8Ms.png'); 
            background-size: cover;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container{
            width: 1500px;
            padding: 30px;
            border: 1px solid #eeeeee;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.7); /* Transparent white background */
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h4 {
            margin-bottom: 10px;
            font-size: 24px;
            color: #23408F; /* Change font color to #23408F */
            text-align: center; /* Center the text horizontally */
        }
       
        .names-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-gap: 10px;
            margin-bottom: 10px;
        }
        .name-block {
            padding: 10px;
            border: 1px solid #000000;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }
        .name-block:hover {
            background-color: #dd9c10;
        }
        .options-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-gap: 10px;
            margin-bottom: 10px;
        }
        .option-block {
            padding: 10px;
            border: 1px solid #000000;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }
        .option-block:hover {
            background-color: #dd9c10;
        }
        #numbering-input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            display: none;
        }
        #submit{
            border: none;
            background-color: orangered;
            color: white;
            width: 200px;
            margin-top: 10px;
            border-radius: 5px;
        }
        #submit:hover{
            background-color: #333333;
        }
        /* Custom loading screen styles */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-spinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .selected {
            background-color: #dd9c10; /* Change to the desired color */
        }
        .option-block.selected {
            background-color: #dd9c10; /* Change to the desired color */
        }

    </style>
</head>
<body>
    <div class="container">
        <img src="https://i.imgur.com/XZvd1fv.png" alt="Sample Image" style="max-width: 100%; height: auto;">
        <form method="post" action="https://script.google.com/macros/s/AKfycbyZJW5Q7OsF5tfQJBTCcEt1V_xnjw2R61TMLvOdMxBnIQZgAzqMZeYi-LaNXAoMhPGN/exec" name="contact-form" onsubmit="return addDateTime()">
            <h4>INVENTORY STOCK COUNT</h4>
            <div class="names-container">
                <div class="name-block" onclick="selectName('Ruth Yap')">Ruth Yap</div>
                <div class="name-block" onclick="selectName('Haeginan')">Haeginan</div>
                <div class="name-block" onclick="selectName('Nur Areef')">Nur Areef</div>
                <div class="name-block" onclick="selectName('Iqbal')">Iqbal</div>
                <div class="name-block" onclick="selectName('Murugesan')">Murugesan</div>
                <div class="name-block" onclick="selectName('Naren')">Naren</div>
                <div class="name-block" onclick="selectName('Thanesh')">Thanesh</div>
                <div class="name-block" onclick="selectName('Theiven')">Theiven</div>
                <div class="name-block" onclick="selectName('Sathiaraj')">Sathiaraj</div>
                <div class="name-block" onclick="selectName('Viknesh')">Viknesh</div>
            </div>
            <div class="options-container" id="options-container" style="display: none;">
                <!-- Options will be populated dynamically -->
            </div>
            <input type="number" name="a-option-value" id="numbering-input" placeholder="Quantity" oninput="updateJobNumber()">
            <input type="hidden" name="date" id="date">
            <input type="hidden" name="day" id="day">
            <input type="hidden" name="time-submission" id="time-submission">
            <input type="hidden" name="Manpower-names" id="manpower-names">
            <input type="hidden" name="Project-Type" id="project-type">
            <input type="hidden" name="Job-Number" id="job-number">
            <input type="submit" value="Submit" id="submit">
        </form>
    </div>

    <!-- Add the loading overlay and spinner HTML -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
    </div>
    
    <script src="Google Sheet.js"></script>
    <script>
        function addDateTime() {
            var now = new Date();
            var dateField = document.getElementById("date");
            var dayField = document.getElementById("day");
            var timeSubmissionField = document.getElementById("time-submission");
    
            // Get the date in yyyy-mm-dd format
            var dateString = now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate();
            dateField.value = dateString;
    
            // Get the day (e.g., Monday, Tuesday, etc.)
            var days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            var dayString = days[now.getDay()];
            dayField.value = dayString;
    
            // Get the current time in GMT+8
            var timeZoneOffset = 8; // GMT+8
            var utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            var gmtPlus8Time = new Date(utc + (3600000 * timeZoneOffset));
            var timeString = gmtPlus8Time.getHours().toString().padStart(2, '0') + ":" + gmtPlus8Time.getMinutes().toString().padStart(2, '0');
            timeSubmissionField.value = timeString;
    
            // Show loading overlay
            showLoadingOverlay();
            return true;
        }
/////////////////
function selectName(name) {
    var optionsContainer = document.getElementById("options-container");
    optionsContainer.innerHTML = ""; // Clear previous options
    var letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H']; // Include both 'A' and 'B'
    optionsContainer.style.whiteSpace = "nowrap"; // Ensure all options appear in the same row
    for (var k = 0; k < 8; k++) { // Loop through letters 'A' and 'B'
        for (var i = 1; i <= 18; i++) { // Loop from 1 to 18
            var optionBlock = document.createElement("div");
            optionBlock.classList.add("option-block");
            optionBlock.textContent = letters[k] + i;
            optionBlock.onclick = function() {
                selectOption(this.textContent);
            };
            optionsContainer.appendChild(optionBlock);
        }
    }
    optionsContainer.style.display = "grid"; // Show the options container
    optionsContainer.style.gridTemplateColumns = "repeat(18, 1fr)"; // Set the grid layout for columns

    // Set the selected name to the hidden input field
    var nameInput = document.getElementById("manpower-names");
    nameInput.value = name;

    // Highlight the selected name block
    var selectedNameBlock = document.querySelector(".name-block.selected");
    if (selectedNameBlock) {
        selectedNameBlock.classList.remove("selected");
    }
    var clickedNameBlock = event.target;
    clickedNameBlock.classList.add("selected");

    var numberingInput = document.getElementById("numbering-input");
    numberingInput.style.display = "none"; // Hide the input box
}

/////////////////////

function selectOption(option) {
    var numberingInput = document.getElementById("numbering-input");
    numberingInput.style.display = "block"; // Show the input box
    var projectTypeField = document.getElementById("project-type");
    projectTypeField.value = option;

    // Highlight the selected option block
    var selectedOptionBlock = document.querySelector(".option-block.selected");
    if (selectedOptionBlock) {
        selectedOptionBlock.classList.remove("selected");
    }
    var clickedOptionBlock = event.target;
    clickedOptionBlock.classList.add("selected");
}
        function updateJobNumber() {
            var jobNumberField = document.getElementById("job-number");
            var enteredValue = document.getElementById("numbering-input").value;
            jobNumberField.value = enteredValue;
        }

        function showLoadingOverlay() {
            var loadingOverlay = document.getElementById("loading-overlay");
            loadingOverlay.style.display = "flex"; // Show the loading overlay
        }
    </script>    
</body>
</html>
